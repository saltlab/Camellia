<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>View Computed Slice</title>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <link type="text/css" rel="stylesheet" href="style/prism.css">
    <script src="javascript/prism.js"></script>
</head>
<body style="overflow-x:hidden">
<h1 id="fileNameGoesHere"></h1>
<button id='prevFile'> Previous </button>
<button id='nextFile'> Next </button>
<pre id="code_pre" class="line-numbers  language-javascript" data-line="">
<code id="code_code" class="  language-javascript">
</code>
</pre>
<script type="text/javascript"> 
    var files = new Array();
    var fileIndex = -1;

    // Get list of all relevant JavaScript files in slice, display first file/slice piece
    var getWhichFile = new XMLHttpRequest();
    getWhichFile.open('GET', 'allFiles.txt');
    getWhichFile.onreadystatechange = function() {
        // When ready/response received, display
        if (this.readyState == 4) {
            var splitMe = getWhichFile.responseText; 
            // Split by spaces
            files = splitMe.split(' ');

            if (files.length > 0) {
                changeFile(null, true); 
            }    
        }
    }
    getWhichFile.send();

    function changeFile(event, next) {
        if (next == true) {
            fileIndex++;
        } else {
            fileIndex--;
        }

        if (fileIndex >= files.length) {
            fileIndex = 0;
        } else if (fileIndex < 0) {
            fileIndex = files.length - 1;
        }

        var client = new XMLHttpRequest();
        client.open('GET', 'source/'+files[fileIndex]+'.js');
        client.onreadystatechange = function() {
            document.getElementById('code_code').innerHTML = client.responseText; 

            // Next, retrieve the line numbers for the slice
            var lineNumbers = new XMLHttpRequest();
            lineNumbers.open('GET', 'lines/'+files[fileIndex]+'.txt');
            lineNumbers.onreadystatechange = function() {
                $('#code_pre').attr("data-line", lineNumbers.responseText);
                Prism.highlightElement($('#code_code')[0]);
            };
            lineNumbers.send();
            document.getElementById('fileNameGoesHere').innerHTML = files[fileIndex] + '.js';
        }
        client.send();
    }
    $('#prevFile').click(function (e) {
        changeFile(e, false);
    });
    $('#nextFile').click(function (e) {
        changeFile(e, true);
    });
</script> 
</body></html>
